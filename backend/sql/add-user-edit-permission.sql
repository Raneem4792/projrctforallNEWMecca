-- =====================================================
-- إضافة صلاحية تعديل المستخدم
-- =====================================================
-- هذا السكريبت يضيف صلاحية "تعديل المستخدم"
-- للتحكم في من يستطيع تعديل بيانات المستخدمين
-- =====================================================

USE makkah_central;

-- إضافة الصلاحية في جدول permissions المركزي
INSERT IGNORE INTO permissions (PermissionKey, NameAr, NameEn, Category, Description)
VALUES (
  'HOSPITAL_USER_EDIT',
  'تعديل المستخدم',
  'Edit User',
  'hospital',
  'صلاحية تعديل بيانات المستخدمين الموجودين في المستشفى'
);

-- =====================================================
-- ملاحظات:
-- =====================================================
-- 1. هذه الصلاحية تُحفظ في جدول user_permissions لكل مستشفى
-- 2. مدير التجمع (Central Admin) له الصلاحية تلقائياً
-- 3. باقي المستخدمين يحتاجون منحها من صفحة الصلاحيات
-- 4. تتحكم في إظهار/إخفاء زر "تعديل" للمستخدمين
-- 5. منفصلة عن صلاحية HOSPITAL_USER_CREATE (إضافة مستخدم)
-- 
-- الفرق بين الصلاحيات:
-- - HOSPITAL_USERS        → إظهار أيقونة "إدارة المستخدمين"
-- - HOSPITAL_USER_CREATE  → إظهار زر "إضافة مستخدم جديد"
-- - HOSPITAL_USER_EDIT    → إظهار زر "تعديل" لكل مستخدم
-- - (يمكن إضافة HOSPITAL_USER_DELETE لاحقاً للحذف)
-- 
-- مثال لمنح الصلاحية يدوياً:
-- 
-- USE hosp_ABC;  -- قاعدة المستشفى
-- INSERT INTO user_permissions (UserID, HospitalID, PermissionKey)
-- VALUES (123, 1, 'HOSPITAL_USER_EDIT');
-- 
-- =====================================================

-- التحقق من إضافة الصلاحية
SELECT PermissionKey, NameAr, Category 
FROM permissions 
WHERE PermissionKey = 'HOSPITAL_USER_EDIT';


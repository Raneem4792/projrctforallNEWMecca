-- =====================================================
-- إضافة صلاحية إنشاء مستخدم جديد
-- =====================================================
-- هذا السكريبت يضيف صلاحية "إضافة مستخدم جديد"
-- للتحكم في من يستطيع إنشاء مستخدمين جدد في المستشفى
-- =====================================================

USE makkah_central;

-- إضافة الصلاحية في جدول permissions المركزي
INSERT IGNORE INTO permissions (PermissionKey, NameAr, NameEn, Category, Description)
VALUES (
  'HOSPITAL_USER_CREATE',
  'إضافة مستخدم جديد',
  'Create New User',
  'hospital',
  'صلاحية إنشاء وإضافة مستخدمين جدد في المستشفى'
);

-- =====================================================
-- ملاحظات:
-- =====================================================
-- 1. هذه الصلاحية تُحفظ في جدول user_permissions لكل مستشفى
-- 2. مدير التجمع (Central Admin) له الصلاحية تلقائياً
-- 3. باقي المستخدمين يحتاجون منحها من صفحة الصلاحيات
-- 4. تتحكم في إظهار/إخفاء زر "إضافة مستخدم جديد"
-- 
-- مثال لمنح الصلاحية يدوياً:
-- 
-- USE hosp_ABC;  -- قاعدة المستشفى
-- INSERT INTO user_permissions (UserID, HospitalID, PermissionKey)
-- VALUES (123, 1, 'HOSPITAL_USER_CREATE');
-- 
-- =====================================================

-- التحقق من إضافة الصلاحية
SELECT PermissionKey, NameAr, Category 
FROM permissions 
WHERE PermissionKey = 'HOSPITAL_USER_CREATE';


# ๐ฏ ุงูุญู ุงูููุงุฆู ููุดููุฉ 404 ูู ุชุชุจุน ุงูุจูุงุบุงุช

## โ **ุชู ุชุทุจูู ุงูุญู ุจูุฌุงุญ!**

### ๐ง **ุงูุชุบููุฑุงุช ุงููุทุจูุฉ:**

#### 1. **Fallback Strategy ูู `/api/complaints/track`**
```javascript
// ุงูุจุญุซ ูู ุงููุงุนุฏุฉ ุงููุฑูุฒูุฉ ุฃููุงู
const [rows] = await centralDb.query(sql, params);

// ุฅุฐุง ูู ุชูุฌุฏ ูุชุงุฆุฌุ ุฌุฑุจ ูุงุนุฏุฉ ุงููุณุชุดูู (ููููุธููู ููุท)
if (!rows.length && req.user?.hospitalId) {
  console.log(`๐ ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุณุชุดูู ${req.user.hospitalId} ูุจุฏูู ุงุญุชูุงุทู`);
  const hospitalPool = await getContextualPool(req.user, req);
  const [localRows] = await hospitalPool.query(sql, params);
  if (localRows.length) {
    console.log(`โ ุชู ุงูุนุซูุฑ ุนูู ${localRows.length} ูุชูุฌุฉ ูู ูุงุนุฏุฉ ุงููุณุชุดูู`);
    return res.json({ ok:true, items: localRows, source: 'hospital' });
  }
}
```

#### 2. **ุชุญุณููุงุช ุงูุฃุฏุงุก**
- ููุงุฑุณ ููุจุญุซ ุงูุณุฑูุน
- ุชุญุณูู ุงูุชุฑููุฒ
- ุฅุญุตุงุฆูุงุช ุงูุฌุฏุงูู

#### 3. **ุฃุฏูุงุช ุงูุชุดุฎูุต**
- `diagnose-data-sync.js` - ูุญุต ุญุงูุฉ ุงูุจูุงูุงุช
- `optimize-central-db.sql` - ุชุญุณูู ุงููุงุนุฏุฉ ุงููุฑูุฒูุฉ

## ๐ **ููู ูุนูู ุงูุญู:**

### ุงูุณููุงุฑูู 1: ููุธู ูุณุชุดูู ูุจุญุซ ุนู "ุฑููู"
1. **ุงูุจุญุซ ุงูุฃูู**: ุงููุงุนุฏุฉ ุงููุฑูุฒูุฉ ูุน `HospitalID = 11`
2. **ุฅุฐุง ูู ุชูุฌุฏ ูุชุงุฆุฌ**: ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุณุชุดูู `hosp_aaaa`
3. **ุงููุชูุฌุฉ**: โ ูุนุซุฑ ุนูู ุงูุจูุงุบ ููุนุฑุถู

### ุงูุณููุงุฑูู 2: ูุฏูุฑ ูุจุญุซ ุนู "ุฑููู"
1. **ุงูุจุญุซ**: ุงููุงุนุฏุฉ ุงููุฑูุฒูุฉ (ูู ุงููุณุชุดููุงุช)
2. **ุงููุชูุฌุฉ**: โ ูุนุซุฑ ุนูู ุฌููุน ุงูุจูุงุบุงุช

### ุงูุณููุงุฑูู 3: ุฒุงุฆุฑ ุนุงุฏู ูุจุญุซ ุนู "ุฑููู"
1. **ุงูุจุญุซ**: ุงููุงุนุฏุฉ ุงููุฑูุฒูุฉ (ูู ุงููุณุชุดููุงุช)
2. **ุงููุชูุฌุฉ**: โ ูุนุซุฑ ุนูู ุงูุจูุงุบุงุช ุงูุนุงูุฉ

## ๐ฏ **ุงููุฒุงูุง:**

โ **ูุนูู ููุฑุงู** - ูุง ูุญุชุงุฌ ูุฒุงููุฉ ูุงููุฉ  
โ **ุขูู** - ุงููุทุงู ูุญููุธ ููููุธููู  
โ **ุฐูู** - ูุฎุชุงุฑ ุงููุงุนุฏุฉ ุงูููุงุณุจุฉ  
โ **ูุฑู** - ูุนูู ูุน ุฃู ูุณุชุดูู  
โ **ุดูุงู** - ููุถุญ ูุตุฏุฑ ุงูุจูุงูุงุช (`source: 'hospital'` ุฃู `'central'`)

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

### ูุจู ุงูุญู:
```
GET /api/complaints/track?name=ุฑููู
โ 404: ูุง ุชูุฌุฏ ูุชุงุฆุฌ ุถูู ุงููุทุงู
```

### ุจุนุฏ ุงูุญู:
```
GET /api/complaints/track?name=ุฑููู
โ 200: { 
    ok: true, 
    items: [
      {
        ComplaintID: 123,
        TicketNumber: "C-2025-00023",
        PatientFullName: "ุฑููู ุฃุญูุฏ",
        HospitalID: 11,
        ...
      }
    ], 
    source: 'hospital' 
  }
```

## ๐ **ูุฑุงูุจุฉ ุงููุชุงุฆุฌ:**

ูู console ุงูุณูุฑูุฑ ุณุชุธูุฑ:
```
๐ ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุณุชุดูู 11 ูุจุฏูู ุงุญุชูุงุทู
โ ุชู ุงูุนุซูุฑ ุนูู 3 ูุชูุฌุฉ ูู ูุงุนุฏุฉ ุงููุณุชุดูู
```

## ๐งช **ุงุฎุชุจุงุฑ ุงูุญู:**

```bash
# 1. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุฑูุฑ
cd backend
npm start

# 2. ุงุฎุชุจุงุฑ ุงูุจุญุซ
# ูู ุงููุชุตูุญ: http://localhost:3000/complaints/track
# ุงุจุญุซ ุนู: ุฑููู
```

## ๐ **ุงูุฎูุงุตุฉ:**

**ุงููุดููุฉ ูุญูููุฉ ุจุงููุงูู!** 

ุงููุธุงู ุงูุขู:
- โ ูุจุญุซ ูู ุงููุงุนุฏุฉ ุงูููุงุณุจุฉ ุชููุงุฆูุงู
- โ ูุนูู ุญุชู ูู ูู ุชุชู ุงููุฒุงููุฉ ุงููุงููุฉ
- โ ูุญุงูุธ ุนูู ุงูุฃูุงู ูุงููุทุงู
- โ ูููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ
- โ ูุงุจู ููุชูุณุน ูุน ูุณุชุดููุงุช ุฌุฏูุฏุฉ

**ูุง ุญุงุฌุฉ ููุฒุงููุฉ ููุฑูุฉ** - ุงููุธุงู ูุนูู ุจุฐูุงุก ูุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ!

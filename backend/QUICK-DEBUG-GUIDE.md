# ๐ ุฏููู ุงูุชุดุฎูุต ุงูุณุฑูุน

## ๐ฏ **ุงููุดููุฉ:**
ุงูุตูุญุฉ ุชุธูุฑ "ูุง ุชูุฌุฏ ุจูุงุบุงุช ูุทุงุจูุฉ ููุจุญุซ" ุฑุบู ุฅุฑุณุงู ุงูุชููู ุจุดูู ุตุญูุญ.

## ๐ **ุงูุชุญููู:**
ูู console ุงููุชุตูุญ:
- โ ุงูุชููู ููุฑุณู: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjMsI...`
- โ ุงูุทูุจ ูุฐูุจ ููุณูุฑูุฑ: `http://localhost:3001/api/complaints/history?page=1&pageSize=9`
- โ ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ุจูุฌุงุญ
- โ ุงููุชุงุฆุฌ ูุงุฑุบุฉ (0 ุจูุงุบุงุช)

## ๐งช **ุงูุฎุทูุงุช ุงูุณุฑูุนุฉ:**

### **1. ูุญุต ุงูุณูุฑูุฑ:**
```bash
cd backend
npm start
# ุชุฃูุฏ ูู ุธููุฑ: "Server running on port 3001"
```

### **2. ูุญุต ุงูุจูุงูุงุช:**
```bash
cd backend
node test-simple-query.js
```

### **3. ูุญุต console ุงูุณูุฑูุฑ:**
ุนูุฏ ูุชุญ ุตูุญุฉ ุณุฌู ุงูุจูุงุบุงุชุ ูุฌุจ ุฃู ุชุฑู:
```
๐ [AUTH] ุงูุชุญูู ูู ุงูุชููู: { hasHeader: true, hasToken: true }
โ [AUTH] ุงูุชููู ุตุงูุญ: { userId: 3, roleId: 2, hospitalId: 11 }
๐ [HISTORY] ุงูุจุญุซ | hasUser: true | hospitalId: 11 | queryHospitalId: none | page: 1
๐ [HISTORY] ุงูููุงุชุฑ: { name: '', mobile: '', file: '', ticket: '', status: 'ALL', from: '', to: '' }
๐ [HISTORY] ุงูุจุงุฑุงููุชุฑุงุช: { page: '1', pageSize: '9' }
๐ [HISTORY] ูุทุงู ุงููุณุชุดูู: { where: ' AND c.HospitalID = ? ', params: [11] }
๐ [HISTORY] ุงุณุชุนูุงู ุงููุฑูุฒูุฉ: SELECT c.ComplaintID AS id...
๐ [HISTORY] ูุนุงููุงุช ุงููุฑูุฒูุฉ: [11, 9, 0]
๐ [HISTORY] ูุชุงุฆุฌ ุงููุฑูุฒูุฉ: { rowsCount: 0, total: 0, kpis: { openCount: 0, closedCount: 0, criticalCount: 0 } }
๐ ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุณุชุดูู 11 ูุจุฏูู ุงุญุชูุงุทู
```

## ๐ง **ุงูุญููู ุงููุญุชููุฉ:**

### **ุงูุญู 1: ุงูุณูุฑูุฑ ูุง ูุนูู**
```bash
cd backend
npm start
```

### **ุงูุญู 2: ูุง ุชูุฌุฏ ุจูุงูุงุช**
```bash
cd backend
node test-simple-query.js
```

### **ุงูุญู 3: ุฎุทุฃ ูู ุงูุชููู**
```javascript
// ูู console ุงููุชุตูุญ:
const token = localStorage.getItem('token');
const payload = JSON.parse(atob(token.split('.')[1]));
console.log('hospitalId:', payload.hospitalId);
```

### **ุงูุญู 4: ูุดููุฉ ูู ุงูุงุณุชุนูุงู**
```bash
cd backend
node -e "
import { centralDb } from './config/db.js';
const [rows] = await centralDb.query('SELECT COUNT(*) as count FROM complaints WHERE HospitalID = 11 AND (IsDeleted IS NULL OR IsDeleted = 0)');
console.log('ุจูุงุบุงุช ูุณุชุดูู 11:', rows[0].count);
"
```

## ๐ฏ **ุงูุฎุทูุงุช ุงูุณุฑูุนุฉ:**

1. **ุดุบู ุงูุณูุฑูุฑ:**
   ```bash
   cd backend
   npm start
   ```

2. **ุงูุชุญ ุตูุญุฉ ุณุฌู ุงูุจูุงุบุงุช**

3. **ุฑุงูุจ console ุงูุณูุฑูุฑ** - ุงุจุญุซ ุนู ุฑุณุงุฆู `[HISTORY]`

4. **ุฅุฐุง ูู ุชุธูุฑ ุฑุณุงุฆู:** ุงูุณูุฑูุฑ ูุง ูุนูู

5. **ุฅุฐุง ุธูุฑุช ุฑุณุงุฆู ููู ุงููุชุงุฆุฌ ูุงุฑุบุฉ:** ูุง ุชูุฌุฏ ุจูุงูุงุช

## ๐จ **ุงููุดุงูู ุงูุดุงุฆุนุฉ:**

### **1. ุงูุณูุฑูุฑ ูุง ูุนูู:**
```
Error: connect ECONNREFUSED localhost:3001
```
**ุงูุญู:** ุดุบู ุงูุณูุฑูุฑ

### **2. ูุง ุชูุฌุฏ ุจูุงูุงุช:**
```
๐ [HISTORY] ูุชุงุฆุฌ ุงููุฑูุฒูุฉ: { rowsCount: 0, total: 0 }
```
**ุงูุญู:** ุฃุถู ุจูุงูุงุช ุชุฌุฑูุจูุฉ

### **3. ุฎุทุฃ ูู ุงูุชููู:**
```
โ [AUTH] ุงูุชููู ุบูุฑ ุตุงูุญ: jwt expired
```
**ุงูุญู:** ุณุฌู ุฏุฎูู ูุฑุฉ ุฃุฎุฑู

---

## ๐ฏ **ุงูุฎูุงุตุฉ:**

**ุงููุดููุฉ ุงูุฃูุซุฑ ุงุญุชูุงูุงู:** ุงูุณูุฑูุฑ ูุง ูุนูู ุฃู ูุง ุชูุฌุฏ ุจูุงูุงุช ูู ุงููุงุนุฏุฉ.

**ุงูุญู ุงูุณุฑูุน:** 
1. ุดุบู ุงูุณูุฑูุฑ
2. ุฑุงูุจ console ุงูุณูุฑูุฑ
3. ุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช
